"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.getAppsFlyerCredentials = void 0;
const moonbeam_models_1 = require("@moonbeam/moonbeam-models");
/**
 * GetAppsFlyerCredentials resolver
 *
 * @param getAppsFlyerCredentialsInput the input needed to retrieve the appropriate API Key
 * @param fieldName name of the resolver path from the AppSync event
 * @returns {@link Promise} of {@link AppsFlyerResponse}
 */
const getAppsFlyerCredentials = async (fieldName, getAppsFlyerCredentialsInput) => {
    try {
        // retrieving the current function region
        const region = process.env.AWS_REGION;
        // initialize a new Apps Flyer client, in order to retrieve the App Upgrade credentials
        const appUpgradeClient = new moonbeam_models_1.AppsFlyerClient(process.env.ENV_NAME, region);
        // return the App Upgrade credentials
        return appUpgradeClient.getAppsFlyerAPIKey(getAppsFlyerCredentialsInput.osType);
    }
    catch (err) {
        const errorMessage = `Unexpected error while executing ${fieldName} query ${err}`;
        console.log(errorMessage);
        return {
            errorMessage: errorMessage,
            errorType: moonbeam_models_1.AppsFlyerErrorType.UnexpectedError
        };
    }
};
exports.getAppsFlyerCredentials = getAppsFlyerCredentials;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiR2V0QXBwc0ZseWVyQ3JlZGVudGlhbHNSZXNvbHZlci5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9sYW1iZGEvcmVzb2x2ZXJzL0dldEFwcHNGbHllckNyZWRlbnRpYWxzUmVzb2x2ZXIudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6Ijs7O0FBQUEsK0RBQStIO0FBRS9IOzs7Ozs7R0FNRztBQUNJLE1BQU0sdUJBQXVCLEdBQUcsS0FBSyxFQUFFLFNBQWlCLEVBQUUsNEJBQTBELEVBQThCLEVBQUU7SUFDdkosSUFBSTtRQUNBLHlDQUF5QztRQUN6QyxNQUFNLE1BQU0sR0FBRyxPQUFPLENBQUMsR0FBRyxDQUFDLFVBQVcsQ0FBQztRQUV2Qyx1RkFBdUY7UUFDdkYsTUFBTSxnQkFBZ0IsR0FBRyxJQUFJLGlDQUFlLENBQUMsT0FBTyxDQUFDLEdBQUcsQ0FBQyxRQUFTLEVBQUUsTUFBTSxDQUFDLENBQUM7UUFFNUUscUNBQXFDO1FBQ3JDLE9BQU8sZ0JBQWdCLENBQUMsa0JBQWtCLENBQUMsNEJBQTRCLENBQUMsTUFBTSxDQUFDLENBQUM7S0FDbkY7SUFBQyxPQUFPLEdBQUcsRUFBRTtRQUNWLE1BQU0sWUFBWSxHQUFHLG9DQUFvQyxTQUFTLFVBQVUsR0FBRyxFQUFFLENBQUM7UUFDbEYsT0FBTyxDQUFDLEdBQUcsQ0FBQyxZQUFZLENBQUMsQ0FBQztRQUMxQixPQUFPO1lBQ0gsWUFBWSxFQUFFLFlBQVk7WUFDMUIsU0FBUyxFQUFFLG9DQUFrQixDQUFDLGVBQWU7U0FDaEQsQ0FBQztLQUNMO0FBQ0wsQ0FBQyxDQUFBO0FBbEJZLFFBQUEsdUJBQXVCLDJCQWtCbkMiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge0FwcHNGbHllckVycm9yVHlwZSwgQXBwc0ZseWVyQ2xpZW50LCBBcHBzRmx5ZXJSZXNwb25zZSwgR2V0QXBwc0ZseWVyQ3JlZGVudGlhbHNJbnB1dH0gZnJvbSBcIkBtb29uYmVhbS9tb29uYmVhbS1tb2RlbHNcIjtcblxuLyoqXG4gKiBHZXRBcHBzRmx5ZXJDcmVkZW50aWFscyByZXNvbHZlclxuICpcbiAqIEBwYXJhbSBnZXRBcHBzRmx5ZXJDcmVkZW50aWFsc0lucHV0IHRoZSBpbnB1dCBuZWVkZWQgdG8gcmV0cmlldmUgdGhlIGFwcHJvcHJpYXRlIEFQSSBLZXlcbiAqIEBwYXJhbSBmaWVsZE5hbWUgbmFtZSBvZiB0aGUgcmVzb2x2ZXIgcGF0aCBmcm9tIHRoZSBBcHBTeW5jIGV2ZW50XG4gKiBAcmV0dXJucyB7QGxpbmsgUHJvbWlzZX0gb2Yge0BsaW5rIEFwcHNGbHllclJlc3BvbnNlfVxuICovXG5leHBvcnQgY29uc3QgZ2V0QXBwc0ZseWVyQ3JlZGVudGlhbHMgPSBhc3luYyAoZmllbGROYW1lOiBzdHJpbmcsIGdldEFwcHNGbHllckNyZWRlbnRpYWxzSW5wdXQ6IEdldEFwcHNGbHllckNyZWRlbnRpYWxzSW5wdXQpOiBQcm9taXNlPEFwcHNGbHllclJlc3BvbnNlPiA9PiB7XG4gICAgdHJ5IHtcbiAgICAgICAgLy8gcmV0cmlldmluZyB0aGUgY3VycmVudCBmdW5jdGlvbiByZWdpb25cbiAgICAgICAgY29uc3QgcmVnaW9uID0gcHJvY2Vzcy5lbnYuQVdTX1JFR0lPTiE7XG5cbiAgICAgICAgLy8gaW5pdGlhbGl6ZSBhIG5ldyBBcHBzIEZseWVyIGNsaWVudCwgaW4gb3JkZXIgdG8gcmV0cmlldmUgdGhlIEFwcCBVcGdyYWRlIGNyZWRlbnRpYWxzXG4gICAgICAgIGNvbnN0IGFwcFVwZ3JhZGVDbGllbnQgPSBuZXcgQXBwc0ZseWVyQ2xpZW50KHByb2Nlc3MuZW52LkVOVl9OQU1FISwgcmVnaW9uKTtcblxuICAgICAgICAvLyByZXR1cm4gdGhlIEFwcCBVcGdyYWRlIGNyZWRlbnRpYWxzXG4gICAgICAgIHJldHVybiBhcHBVcGdyYWRlQ2xpZW50LmdldEFwcHNGbHllckFQSUtleShnZXRBcHBzRmx5ZXJDcmVkZW50aWFsc0lucHV0Lm9zVHlwZSk7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgIGNvbnN0IGVycm9yTWVzc2FnZSA9IGBVbmV4cGVjdGVkIGVycm9yIHdoaWxlIGV4ZWN1dGluZyAke2ZpZWxkTmFtZX0gcXVlcnkgJHtlcnJ9YDtcbiAgICAgICAgY29uc29sZS5sb2coZXJyb3JNZXNzYWdlKTtcbiAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgIGVycm9yTWVzc2FnZTogZXJyb3JNZXNzYWdlLFxuICAgICAgICAgICAgZXJyb3JUeXBlOiBBcHBzRmx5ZXJFcnJvclR5cGUuVW5leHBlY3RlZEVycm9yXG4gICAgICAgIH07XG4gICAgfVxufVxuIl19